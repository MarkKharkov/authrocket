function _inherits(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var _get=function(e,r,t){for(var n=!0;n;){var o=e,i=r,s=t;u=a=c=void 0,n=!1,null===o&&(o=Function.prototype);var u=Object.getOwnPropertyDescriptor(o,i);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(o);if(null===a)return void 0;e=a,r=i,t=s,n=!0}},_createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}();!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("lodash"),require("superagent")):"function"==typeof define&&define.amd?define(["lodash","superagent"],r):e.AuthRocket=r(e._,e.superagent)}(this,function(e,r){"use strict";function t(r){return e.isString(r)?r.replace(/\/$/,""):(logger.error({description:"Slash can only be removed from strings.",func:"removeTrailingSlash",file:"config"}),r)}function n(e,r){return e&&console[e]?console[e].apply(console,r):console.log.apply(console,r)}function o(e){var r="",t={};c.isObject(e)?("debug"==h&&c.has(e,"func")&&(r+=c.has(e,"obj")?"["+e.obj+"."+e.func+"()]\n ":c.has(e,"file")?"["+e.file+" > "+e.func+"()]\n ":"["+e.func+"()]\n "),c.each(c.omit(c.keys(e)),function(n,o,i){"func"!=n&&"obj"!=n&&("description"==n||"message"==n?r+=e[n]:c.isString(e[n])?t[n]=e[n]:t[n]=e[n])}),r+="\n"):c.isString(e)&&(r=e);var n=[r,t];return n}function i(e){return new Promise(function(r,t){e.end(function(e,n){return e?(401==e.status&&g.warn({description:"Unauthorized. You must be signed into make this request.",func:"handleResponse"}),e&&e.response?t(e.response.text):(g.warn({description:"Error response.",error:e,func:"handleResponse"}),t(e))):r(n.body)})})}function s(r){var t=r;if(!d.accountId||!d.apiKey||!d.realmId)return g.error({description:"AccountId, apiKey, and realmId are required."}),r;var n={"X-Authrocket-Account":d.accountId,"X-Authrocket-Api-Key":d.apiKey,"X-Authrocket-Realm":d.realmId,"Content-Type":"application/json"};return g.log({description:"addAuthRocketHeaders called.",config:d}),e.each(e.keys(n),function(e){t=u(r,e,n[e])}),g.log({description:"addAuthRocketHeaders request created.",request:t}),t}function u(e,r,t){return r&&t?(g.log({description:"Header value set.",headerName:r,headerVal:t}),e.set(r,t)):void g.error({description:"Header name and value required to add header to request.",func:"addHeaderToReq",obj:"request"})}var c="default"in e?e["default"]:e;r="default"in r?r["default"]:r;var a=Object.defineProperties({},{Realms:{get:function(){return m},configurable:!0,enumerable:!0},Users:{get:function(){return y},configurable:!0,enumerable:!0},Credentials:{get:function(){return j},configurable:!0,enumerable:!0},SignupTokens:{get:function(){return k},configurable:!0,enumerable:!0},Orgs:{get:function(){return _},configurable:!0,enumerable:!0},Memberships:{get:function(){return A},configurable:!0,enumerable:!0},AuthProviders:{get:function(){return C},configurable:!0,enumerable:!0},ConnectedApps:{get:function(){return O},configurable:!0,enumerable:!0},Hooks:{get:function(){return P},configurable:!0,enumerable:!0},Sessions:{get:function(){return E},configurable:!0,enumerable:!0},Events:{get:function(){return w},configurable:!0,enumerable:!0},Notifications:{get:function(){return R},configurable:!0,enumerable:!0}}),l={accountId:process.env.AUTHROCKET_ACCOUNT_ID,apiKey:process.env.AUTHROCKET_API_KEY,realmId:process.env.AUTHROCKET_REALM_ID,jwtSecret:process.env.AUTHROCKET_JWT_SECRET,apiUrl:process.env.AUTHROCKET_API_URL||"https://api-e1.authrocket.com/v1/",jsUrl:process.env.AUTHROCKET_JS_URL},f=null,p=function(){function r(){return _classCallCheck(this,r),f||(f=this),e.merge(f,l)}return _createClass(r,[{key:"applySettings",value:function(r){var t=this;e.each(e.keys(r),function(e){t[e]=r[e]})}},{key:"urls",get:function(){var e=this.jsUrl,r=this.apiUrl;return Object.defineProperties({},{api:{get:function(){return r?t(r):null},configurable:!0,enumerable:!0},js:{get:function(){return e?t(e):null},configurable:!0,enumerable:!0}})}}]),r}(),d=new p,h="debug";d.logLevel&&(h=d.logLevel);var g={log:function(e){var r=o(e);"production"==d.envName?n("log",r):n("log",r)},info:function(e){var r=o(e);"production"==d.envName?n("info",r):n("info",r)},warn:function(e){var r=o(e);"production"==d.envName?n("warn",r):n("warn",r)},debug:function(e){var r=o(e);"production"==d.envName||n("debug",r)},error:function(e){var r=o(e);"production"==d.envName?n("error",r):n("error",r)}},b={get:function(e,t){var n=r.get(e);return t&&n.query(t),n=s(n),i(n)},post:function(e,t){var n=r.post(e).send(t);return n=s(n),i(n)},put:function(e,t){var n=r.put(e,t);return n=s(n),i(n)},del:function(e,t){var n=r.put(e,t);return n=s(n),i(n)},withHeaders:function(e,t,n){var o=r[e](t);return o=s(o),i(o)}},v=function(){function r(e,t,n){_classCallCheck(this,r),this.name=e,this.endpoint=n?n:""+this.name,this.init(t)}return _createClass(r,[{key:"init",value:function(r){g.log({description:"Init action called.",actionData:r,func:"url",obj:"Action"}),this.isList=r?!1:!0,this.isList||(this.actionData=r,e.isString(r)?this.id=this.actionData:e.has(r,"id")||e.has(r,"username")?this.id=r.id?r.id:r.username:(g.warn({description:"Invalid action data object.",func:"constructor",obj:"Action"}),this.isList=!1))}},{key:"get",value:function(){return b.get(this.url).then(function(r){return g.log({description:"Get responded successfully.",res:r,func:"get",obj:"Action"}),e.has(r,"error")?(g.error({description:"Error in get response.",error:r.error,res:r,func:"get",obj:"Action"}),Promise.reject(r.error)):r.collection?r.collection:r},function(e){return g.error({description:"Error in GET request.",error:e,func:"get",obj:"Action"}),Promise.reject(e)})}},{key:"add",value:function(r){return b.post(this.url,r).then(function(r){return g.log({description:"Add request responded successfully.",res:r,func:"add",obj:"Action"}),e.has(r,"error")?(g.error({description:"Error creating new user.",error:r.error,res:r,func:"add",obj:"Action"}),Promise.reject(r.error)):(g.log({description:"Add successful.",res:r,func:"add",obj:"Action"}),r)},function(e){return g.error({description:"Error creating new user.",error:e,func:"add",obj:"Action"}),Promise.reject(e)})}},{key:"update",value:function(r){return b.put(this.url,r).then(function(r){return e.has(r,"error")?(g.error({description:"Error in update request.",error:r.error,res:r,func:"update",obj:"Action"}),Promise.reject(r.error)):(g.log({description:"Update successful.",res:r,func:"update",obj:"Action"}),r)},function(e){return g.error({description:"Error in update request.",error:e,func:"update",obj:"Action"}),Promise.reject(e)})}},{key:"remove",value:function(){return b.del(this.url).then(function(r){return e.has(r,"error")?(g.error({description:"Error in request for removal.",error:r.error,res:r,func:"remove",obj:"Action"}),Promise.reject(r.error)):(g.log({description:"Remove successfully.",res:r,func:"remove",obj:"Action"}),r)},function(e){return g.error({description:"Error in request for removal.",error:e,func:"remove",obj:"Action"}),Promise.reject(e)})}},{key:"url",get:function(){var e=this.isList?d.urls.api+"/"+this.endpoint:d.urls.api+"/"+this.endpoint+"/"+this.id;return g.log({description:"Url created.",url:e,func:"url",obj:"Action"}),e}}]),r}(),m=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"realms",e)}return _inherits(r,e),r}(v),y=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"users",e)}return _inherits(r,e),r}(v),j=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"credentials",e)}return _inherits(r,e),r}(v),k=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"signup_tokens",e)}return _inherits(r,e),r}(v),_=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"orgs",e)}return _inherits(r,e),r}(v),A=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"memberships",e)}return _inherits(r,e),r}(v),C=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"auth_providers",e)}return _inherits(r,e),r}(v),O=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"login_policies",e)}return _inherits(r,e),r}(v),P=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"app_hooks",e)}return _inherits(r,e),r}(v),E=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"session",e)}return _inherits(r,e),r}(v),w=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"events",e)}return _inherits(r,e),r}(v),R=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"notifications",e)}return _inherits(r,e),r}(v);console.log("actions:",a);var T=function(){function e(r){_classCallCheck(this,e),r&&c.isString(r)?this.apiUrl=r:d.applySettings(r)}return _createClass(e,[{key:"login",value:function(e){return(c.has(e,"username")||c.has(e,"email"))&&c.has(e,"username")?b.post(d.urls.js+"/login",e).then(function(e){if(g.log({description:"successful login",res:e}),c.has(e,"error"))return g.error({description:"Error logging in.",error:e.error,res:e,func:"login",obj:"AuthRocket"}),Promise.reject(e.error);if(c.has(e,"errno")){var r=e.errno,t="Error signing up.";return"ENOTFOUND"===r&&(r="User not found.",t=r),g.error({description:r,error:e.errno,res:e,func:"login",obj:"AuthRocket"}),Promise.reject(r)}return e},function(e){return g.error({description:"Error logging in.",error:e}),Promise.reject(e)}):(g.error({description:"Username/Email and password are required to login.",func:"login",obj:"AuthRocket"}),Promise.reject("Username/Email and password are required."))}},{key:"logout",value:function(e){return e&&c.isString(e)?b.post(d.urls.js+"/logout",{token:e}).then(function(e){return c.has(e,"error")||c.has(e,"errno")?(g.error({description:"Error logging out.",error:e.error||e.errno,res:e,func:"logout",obj:"AuthRocket"}),Promise.reject(e.error||e.errno)):(g.log({description:"Successful logout.",res:e,func:"logout",obj:"AuthRocket"}),e)},function(e){return g.error({description:"Error logging out.",error:e}),Promise.reject(e)}):(g.error({description:"Token string is required to logout.",func:"logout",obj:"AuthRocket"}),Promise.reject("Valid token is required to logout."))}},{key:"signup",value:function(e){return(c.has(e,"username")||c.has(e,"email"))&&c.has(e,"username")?b.post(d.urls.js+"/signup",e).then(function(e){return c.has(e,"error")||c.has(e,"errno")?(g.error({description:"Error signing up.",error:e.error||e.errno,res:e,func:"signup",obj:"AuthRocket"}),Promise.reject(e.error||e.errno)):(g.log({description:"Successful signup",res:e,func:"signup",obj:"AuthRocket"}),e)},function(e){return g.error({description:"Error signing up.",error:e,func:"signup",obj:"AuthRocket"}),Promise.reject(e)}):(g.error({description:"Username/Email and password are required to login.",func:"login",obj:"AuthRocket"}),Promise.reject("Username/Email and password are required."))}},{key:"verify",value:function(e){return b.get(d.urls.js+"/sessions/"+e).then(function(e){return g.log({description:"Token/Session is valid.",res:e,func:"verify",obj:"AuthRocket"}),c.has(e,"error")?(g.error({description:"Error verifying token/session.",error:e.error,res:e,func:"verify",obj:"AuthRocket"}),Promise.reject(e.error)):e},function(e){return g.error({description:"Token/Session is invalid.",error:e,func:"verify",obj:"AuthRocket"}),Promise.reject(e)})}},{key:"Realms",value:function(e){return new a.Realms(e)}},{key:"Users",value:function(e){return new a.Users(e)}},{key:"Credentials",value:function(e){return new a.Credentials(e)}},{key:"SignupTokens",value:function(e){return new a.SignupTokens(e)}},{key:"Orgs",value:function(e){return new a.Orgs(e)}},{key:"Memberships",value:function(e){return new a.Memberships(e)}},{key:"AuthProviders",value:function(e){return new a.AuthProviders(e)}},{key:"ConnectedApps",value:function(e){return new a.ConnectedApps(e)}},{key:"Hooks",value:function(e){return new a.Hooks(e)}},{key:"Sessions",value:function(e){return new a.Sessions(e)}},{key:"Events",value:function(e){return new a.Events(e)}},{key:"Notifications",value:function(e){return new a.Notifications(e)}}]),e}();return T});
//# sourceMappingURL=authrocket.min.js.map
