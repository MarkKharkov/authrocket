function _classCallCheck(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function r(r,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(r,o.key,o)}}return function(e,n,o){return n&&r(e.prototype,n),o&&r(e,o),e}}();!function(r,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("lodash"),require("superagent")):"function"==typeof define&&define.amd?define(["lodash","superagent"],e):r.AuthRocket=e(r._,r.superagent)}(this,function(r,e){"use strict";function n(e){return r.isString(e)?e.replace(/\/$/,""):(logger.error({description:"Slash can only be removed from strings.",func:"removeTrailingSlash",file:"config"}),e)}function o(r,e){return r&&console[r]?console[r].apply(console,e):console.log.apply(console,e)}function t(r){var e="",n={};c.isObject(r)?("debug"==g&&c.has(r,"func")&&(e+=c.has(r,"obj")?"["+r.obj+"."+r.func+"()]\n ":c.has(r,"file")?"["+r.file+" > "+r.func+"()]\n ":"["+r.func+"()]\n "),c.each(c.omit(c.keys(r)),function(o,t,i){"func"!=o&&"obj"!=o&&("description"==o||"message"==o?e+=r[o]:c.isString(r[o])?n[o]=r[o]:n[o]=r[o])}),e+="\n"):c.isString(r)&&(e=r);var o=[e,n];return o}function i(r){return new Promise(function(e,n){r.end(function(r,o){return r?(401==r.status&&d.warn({description:"Unauthorized. You must be signed into make this request.",func:"handleResponse"}),r&&r.response?n(r.response.text):(d.warn({description:"Error response.",error:r,func:"handleResponse"}),n(r))):e(o.body)})})}function u(e){var n=e;if(!p.accountId||!p.apiKey||!p.realmId)return void d.error({description:"AccountId, apiKey, and realmId are required."});var o={"X-Authrocket-Account":p.accountId,"X-Authrocket-Api-Key":p.apiKey,"X-Authrocket-Realm":p.realmId,Accept:"application/json","Content-Type":"application/json"};return r.each(r.keys(o),function(r){n=s(e,r,o[r])}),n}function s(r,e,n){return e&&n?r.set(e,n):void d.error({description:"Header name and value required to add header to request.",func:"addHeaderToReq",obj:"request"})}var c="default"in r?r["default"]:r;e="default"in e?e["default"]:e;var a={accountId:process.env.AUTHROCKET_ACCOUNT_ID,apiKey:process.env.AUTHROCKET_API_KEY,realmId:process.env.AUTHROCKET_REALM_ID,jwtSecret:process.env.AUTHROCKET_JWT_SECRET,apiUrl:process.env.AUTHROCKET_API_URL||"https://api-e1.authrocket.com/v1/",jsUrl:process.env.AUTHROCKET_JS_URL},l=null,f=function(){function e(){return _classCallCheck(this,e),l||(l=this),r.merge(l,a)}return _createClass(e,[{key:"applySettings",value:function(e){var n=this;r.each(r.keys(e),function(r){n[r]=e[r]})}},{key:"urls",get:function(){var r=this.jsUrl,e=this.apiUrl;return Object.defineProperties({},{api:{get:function(){return e?n(e):null},configurable:!0,enumerable:!0},js:{get:function(){return r?n(r):null},configurable:!0,enumerable:!0}})}}]),e}(),p=new f,g="debug";p.logLevel&&(g=p.logLevel);var d={log:function(r){var e=t(r);"production"==p.envName?o("log",e):o("log",e)},info:function(r){var e=t(r);"production"==p.envName?o("info",e):o("info",e)},warn:function(r){var e=t(r);"production"==p.envName?o("warn",e):o("warn",e)},debug:function(r){var e=t(r);"production"==p.envName||o("debug",e)},error:function(r){var e=t(r);"production"==p.envName?o("error",e):o("error",e)}},h={get:function(r,n){var o=e.get(r);return n&&o.query(n),i(o)},post:function(r,n){var o=e.post(r).send(n);return i(o)},put:function(r,n){var o=e.put(r,n);return i(o)},del:function(r,n){var o=e.put(r,n);return i(o)},withHeaders:function(r,n,o){var t=e[r](n);return t=u(t),i(t)}},v=function(){function e(r){_classCallCheck(this,e)}return _createClass(e,[{key:"get",value:function(e){return h.get(p.urls.api+"/users/"+e.username,loginData).then(function(e){return d.log({description:"successful login",res:e}),r.has(e,"error")?(d.error({description:"Error signing up.",error:e.error,res:e,func:"signup",obj:"AuthRocket"}),Promise.reject(e.error)):e},function(r){return d.error({description:"Error logging in.",error:r}),Promise.reject(r)})}},{key:"remove",value:function(e){return h.del(p.urls.api+"/users/"+e.username,e).then(function(e){return r.has(e,"error")?(d.error({description:"Error removing user.",error:e.error,res:e,func:"signup",obj:"AuthRocket"}),Promise.reject(e.error)):(d.log({description:"User removed successfully.",res:e,func:"signup",obj:"AuthRocket"}),e)},function(r){return d.error({description:"Error removing user.",error:r,func:"signup",obj:"AuthRocket"}),Promise.reject(r)})}}]),e}(),j=function(){function r(e){_classCallCheck(this,r)}return _createClass(r,[{key:"get",value:function(){return h.withHeaders("get",p.urls.api+"/users").then(function(r){return d.log({description:"Users list loaded successfully.",res:r,func:"get",obj:"UsersAction"}),c.has(r,"error")?(d.error({description:"Error signing up.",error:r.error,res:r,func:"signup",obj:"Users"}),Promise.reject(r.error)):r.collection?r.collection:r},function(r){return d.error({description:"Error getting users/",error:r}),Promise.reject(r)})}},{key:"add",value:function(r){return h.post(p.urls.api+"/users",r).then(function(r){return d.log({description:"Successful created new user",res:r}),c.has(r,"error")?(d.error({description:"Error creating new user.",error:r.error,res:r,func:"signup",obj:"Users"}),Promise.reject(r.error)):r},function(r){return d.error({description:"Error creating new user.",error:r}),Promise.reject(r)})}}]),r}(),m=function(){function r(e){_classCallCheck(this,r),e&&c.isString(e)?this.apiUrl=e:p.applySettings(e)}return _createClass(r,[{key:"login",value:function(r){return h.post(p.urls.js+"/login",r).then(function(r){return d.log({description:"successful login",res:r}),c.has(r,"error")?(d.error({description:"Error signing up.",error:r.error,res:r,func:"signup",obj:"AuthRocket"}),Promise.reject(r.error)):r},function(r){return d.error({description:"Error logging in.",error:r}),Promise.reject(r)})}},{key:"logout",value:function(r){return console.log("config:",p.urls.js),h.post(p.urls.js+"/logout",{token:r}).then(function(r){return d.log({description:"successful logout",res:r}),c.has(r,"error")?(d.error({description:"Error signing up.",error:r.error,res:r,func:"signup",obj:"AuthRocket"}),Promise.reject(r.error)):r},function(r){return d.error({description:"Error logging out.",error:r}),Promise.reject(r)})}},{key:"signup",value:function(r){return h.post(p.urls.js+"/signup",r).then(function(r){return c.has(r,"error")?(d.error({description:"Error signing up.",error:r.error,res:r,func:"signup",obj:"AuthRocket"}),Promise.reject(r.error)):(d.log({description:"Successful signup",res:r,func:"signup",obj:"AuthRocket"}),r)},function(r){return d.error({description:"Error signing up.",error:r,func:"signup",obj:"AuthRocket"}),Promise.reject(r)})}},{key:"verify",value:function(r){return h.post(p.urls.js+"/sessions/"+r).then(function(r){return d.log({description:"token is valid",res:r,func:"verify",obj:"AuthRocket"}),c.has(r,"error")?(d.error({description:"Error signing up.",error:r.error,res:r,func:"signup",obj:"AuthRocket"}),Promise.reject(r.error)):r},function(r){return d.error({description:"Token is invalid.",error:r,func:"verify",obj:"AuthRocket"}),Promise.reject(r)})}},{key:"User",value:function(r){return new v(r)}},{key:"Users",get:function(){return new j}}]),r}();return m});
//# sourceMappingURL=authrocket.min.js.map
