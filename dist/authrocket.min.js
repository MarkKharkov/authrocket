function _inherits(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var _get=function(e,r,t){for(var n=!0;n;){var o=e,i=r,s=t;c=a=u=void 0,n=!1,null===o&&(o=Function.prototype);var c=Object.getOwnPropertyDescriptor(o,i);if(void 0!==c){if("value"in c)return c.value;var u=c.get;return void 0===u?void 0:u.call(s)}var a=Object.getPrototypeOf(o);if(null===a)return void 0;e=a,r=i,t=s,n=!0}},_createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}();!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("lodash"),require("superagent")):"function"==typeof define&&define.amd?define(["lodash","superagent"],r):e.AuthRocket=r(e._,e.superagent)}(this,function(e,r){"use strict";function t(r){return e.isString(r)?r.replace(/\/$/,""):(logger.error({description:"Slash can only be removed from strings.",func:"removeTrailingSlash",file:"config"}),r)}function n(e,r){return e&&console[e]?console[e].apply(console,r):console.log.apply(console,r)}function o(e){var r="",t={};u.isObject(e)?("debug"==d&&u.has(e,"func")&&(r+=u.has(e,"obj")?"["+e.obj+"."+e.func+"()]\n ":u.has(e,"file")?"["+e.file+" > "+e.func+"()]\n ":"["+e.func+"()]\n "),u.each(u.omit(u.keys(e)),function(n,o,i){"func"!=n&&"obj"!=n&&("description"==n||"message"==n?r+=e[n]:u.isString(e[n])?t[n]=e[n]:t[n]=e[n])}),r+="\n"):u.isString(e)&&(r=e);var n=[r,t];return n}function i(e){return new Promise(function(r,t){e.end(function(e,n){return e?(401==e.status&&h.warn({description:"Unauthorized. You must be signed into make this request.",func:"handleResponse"}),e&&e.response?t(e.response.text):(h.warn({description:"Error response.",error:e,func:"handleResponse"}),t(e))):r(n.body)})})}function s(r){var t=r;if(!p.accountId||!p.apiKey||!p.realmId)return h.error({description:"AccountId, apiKey, and realmId are required."}),r;var n={"X-Authrocket-Account":p.accountId,"X-Authrocket-Api-Key":p.apiKey,"X-Authrocket-Realm":p.realmId,"Content-Type":"application/json"};return h.log({description:"addAuthRocketHeaders called.",config:p}),e.each(e.keys(n),function(e){t=c(r,e,n[e])}),h.log({description:"addAuthRocketHeaders request created.",request:t}),t}function c(e,r,t){return r&&t?(h.log({description:"Header value set.",headerName:r,headerVal:t}),e.set(r,t)):void h.error({description:"Header name and value required to add header to request.",func:"addHeaderToReq",obj:"request"})}var u="default"in e?e["default"]:e;r="default"in r?r["default"]:r;var a={accountId:process.env.AUTHROCKET_ACCOUNT_ID,apiKey:process.env.AUTHROCKET_API_KEY,realmId:process.env.AUTHROCKET_REALM_ID,jwtSecret:process.env.AUTHROCKET_JWT_SECRET,apiUrl:process.env.AUTHROCKET_API_URL||"https://api-e1.authrocket.com/v1/",jsUrl:process.env.AUTHROCKET_JS_URL},l=null,f=function(){function r(){return _classCallCheck(this,r),l||(l=this),e.merge(l,a)}return _createClass(r,[{key:"applySettings",value:function(r){var t=this;e.each(e.keys(r),function(e){t[e]=r[e]})}},{key:"urls",get:function(){var e=this.jsUrl,r=this.apiUrl;return Object.defineProperties({},{api:{get:function(){return r?t(r):null},configurable:!0,enumerable:!0},js:{get:function(){return e?t(e):null},configurable:!0,enumerable:!0}})}}]),r}(),p=new f,d="debug";p.logLevel&&(d=p.logLevel);var h={log:function(e){var r=o(e);"production"==p.envName?n("log",r):n("log",r)},info:function(e){var r=o(e);"production"==p.envName?n("info",r):n("info",r)},warn:function(e){var r=o(e);"production"==p.envName?n("warn",r):n("warn",r)},debug:function(e){var r=o(e);"production"==p.envName||n("debug",r)},error:function(e){var r=o(e);"production"==p.envName?n("error",r):n("error",r)}},g={get:function(e,t){var n=r.get(e);return t&&n.query(t),n=s(n),i(n)},post:function(e,t){var n=r.post(e).send(t);return n=s(n),i(n)},put:function(e,t){var n=r.put(e,t);return n=s(n),i(n)},del:function(e,t){var n=r.put(e,t);return n=s(n),i(n)},withHeaders:function(e,t,n){var o=r[e](t);return o=s(o),i(o)}},v=function(){function r(e,t,n){_classCallCheck(this,r),this.name=e,this.endpoint=n?n:""+this.name,this.init(t)}return _createClass(r,[{key:"init",value:function(r){h.log({description:"Init action called.",actionData:r,func:"url",obj:"Action"}),this.isList=r?!1:!0,this.isList||(this.actionData=r,e.isString(r)?this.id=this.actionData:e.has(r,"id")||e.has(r,"username")?this.id=r.id?r.id:r.username:(h.warn({description:"Invalid action data object.",func:"constructor",obj:"Action"}),this.isList=!1))}},{key:"get",value:function(){return g.get(this.url).then(function(r){return h.log({description:"Get responded successfully.",res:r,func:"get",obj:"Action"}),e.has(r,"error")?(h.error({description:"Error in get response.",error:r.error,res:r,func:"get",obj:"Action"}),Promise.reject(r.error)):r.collection?r.collection:r},function(e){return h.error({description:"Error in GET request.",error:e,func:"get",obj:"Action"}),Promise.reject(e)})}},{key:"add",value:function(r){return g.post(this.url,r).then(function(r){return h.log({description:"Add request responded successfully.",res:r,func:"add",obj:"Action"}),e.has(r,"error")?(h.error({description:"Error creating new user.",error:r.error,res:r,func:"add",obj:"Action"}),Promise.reject(r.error)):(h.log({description:"Add successful.",res:r,func:"add",obj:"Action"}),r)},function(e){return h.error({description:"Error creating new user.",error:e,func:"add",obj:"Action"}),Promise.reject(e)})}},{key:"update",value:function(r){return g.put(this.url,r).then(function(r){return e.has(r,"error")?(h.error({description:"Error in update request.",error:r.error,res:r,func:"update",obj:"Action"}),Promise.reject(r.error)):(h.log({description:"Update successful.",res:r,func:"update",obj:"Action"}),r)},function(e){return h.error({description:"Error in update request.",error:e,func:"update",obj:"Action"}),Promise.reject(e)})}},{key:"remove",value:function(){return g.del(this.url).then(function(r){return e.has(r,"error")?(h.error({description:"Error in request for removal.",error:r.error,res:r,func:"remove",obj:"Action"}),Promise.reject(r.error)):(h.log({description:"Remove successfully.",res:r,func:"remove",obj:"Action"}),r)},function(e){return h.error({description:"Error in request for removal.",error:e,func:"remove",obj:"Action"}),Promise.reject(e)})}},{key:"url",get:function(){var e=this.isList?p.urls.api+"/"+this.endpoint:p.urls.api+"/"+this.endpoint+"/"+this.id;return h.log({description:"Url created.",url:e,func:"url",obj:"Action"}),e}}]),r}(),y=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"realms",e)}return _inherits(r,e),r}(v),j=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"users",e)}return _inherits(r,e),r}(v),b=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"credentials",e)}return _inherits(r,e),r}(v),k=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"signup_tokens",e)}return _inherits(r,e),r}(v),_=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"orgs",e)}return _inherits(r,e),r}(v),m=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"memberships",e)}return _inherits(r,e),r}(v),C=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"auth_providers",e)}return _inherits(r,e),r}(v),A=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"login_policies",e)}return _inherits(r,e),r}(v),O=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"app_hooks",e)}return _inherits(r,e),r}(v),P=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"session",e)}return _inherits(r,e),r}(v),w=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"events",e)}return _inherits(r,e),r}(v),E=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"notifications",e)}return _inherits(r,e),r}(v),R={Realms:y,Users:j,Credentials:b,SignupTokens:k,Orgs:_,Memberships:m,AuthProviders:C,ConnectedApps:A,Hooks:O,Sessions:P,Events:w,Notifications:E};console.log("actions:",R);var T=function(){function e(r){_classCallCheck(this,e),r&&u.isString(r)?this.apiUrl=r:p.applySettings(r)}return _createClass(e,[{key:"login",value:function(e){return g.post(p.urls.js+"/login",e).then(function(e){return h.log({description:"successful login",res:e}),u.has(e,"error")?(h.error({description:"Error signing up.",error:e.error,res:e,func:"signup",obj:"AuthRocket"}),Promise.reject(e.error)):e},function(e){return h.error({description:"Error logging in.",error:e}),Promise.reject(e)})}},{key:"logout",value:function(e){return console.log("config:",p.urls.js),g.post(p.urls.js+"/logout",{token:e}).then(function(e){return h.log({description:"successful logout",res:e}),u.has(e,"error")?(h.error({description:"Error signing up.",error:e.error,res:e,func:"signup",obj:"AuthRocket"}),Promise.reject(e.error)):e},function(e){return h.error({description:"Error logging out.",error:e}),Promise.reject(e)})}},{key:"signup",value:function(e){return g.post(p.urls.js+"/signup",e).then(function(e){return u.has(e,"error")?(h.error({description:"Error signing up.",error:e.error,res:e,func:"signup",obj:"AuthRocket"}),Promise.reject(e.error)):(h.log({description:"Successful signup",res:e,func:"signup",obj:"AuthRocket"}),e)},function(e){return h.error({description:"Error signing up.",error:e,func:"signup",obj:"AuthRocket"}),Promise.reject(e)})}},{key:"verify",value:function(e){return g.post(p.urls.js+"/sessions/"+e).then(function(e){return h.log({description:"token is valid",res:e,func:"verify",obj:"AuthRocket"}),u.has(e,"error")?(h.error({description:"Error signing up.",error:e.error,res:e,func:"signup",obj:"AuthRocket"}),Promise.reject(e.error)):e},function(e){return h.error({description:"Token is invalid.",error:e,func:"verify",obj:"AuthRocket"}),Promise.reject(e)})}},{key:"Realms",value:function(e){return new y(e)}},{key:"Users",value:function(e){return new j(e)}},{key:"Credentials",value:function(e){return new b(e)}},{key:"SignupTokens",value:function(e){return new k(e)}},{key:"Orgs",value:function(e){return new _(e)}},{key:"Memberships",value:function(e){return new m(e)}},{key:"AuthProviders",value:function(e){return new C(e)}},{key:"ConnectedApps",value:function(e){return new A(e)}},{key:"Hooks",value:function(e){return new O(e)}},{key:"Sessions",value:function(e){return new P(e)}},{key:"Events",value:function(e){return new w(e)}},{key:"Notifications",value:function(e){return new E(e)}}]),e}();return T});
//# sourceMappingURL=authrocket.min.js.map
