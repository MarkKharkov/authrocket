function _inherits(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var _get=function(e,r,t){for(var n=!0;n;){var o=e,i=r,s=t;u=a=c=void 0,n=!1,null===o&&(o=Function.prototype);var u=Object.getOwnPropertyDescriptor(o,i);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(o);if(null===a)return void 0;e=a,r=i,t=s,n=!0}},_createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}();!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("lodash"),require("superagent")):"function"==typeof define&&define.amd?define(["lodash","superagent"],r):e.AuthRocket=r(e._,e.superagent)}(this,function(e,r){"use strict";function t(r){return e.isString(r)?r.replace(/\/$/,""):(logger.error({description:"Slash can only be removed from strings.",func:"removeTrailingSlash",file:"config"}),r)}function n(e,r){return e&&console[e]?console[e].apply(console,r):console.log.apply(console,r)}function o(e){var r="",t={};a.isObject(e)?("debug"==h&&a.has(e,"func")&&(r+=a.has(e,"obj")?"["+e.obj+"."+e.func+"()]\n ":a.has(e,"file")?"["+e.file+" > "+e.func+"()]\n ":"["+e.func+"()]\n "),a.each(a.omit(a.keys(e)),function(n,o,i){"func"!=n&&"obj"!=n&&("description"==n||"message"==n?r+=e[n]:a.isString(e[n])?t[n]=e[n]:t[n]=e[n])}),r+="\n"):a.isString(e)&&(r=e);var n=[r,t];return n}function i(e,r){return"undefined"==typeof r||r?u(e):e}function s(e){return new Promise(function(r,t){e.end(function(e,n){return e?(b.warn({description:"Error response.",error:e,func:"handleResponse"}),401==e.status&&b.warn({description:"Unauthorized. You must be signed into make this request.",func:"handleResponse"}),t(e&&e.response?e.response.text:e&&e.errno?e.errno:e)):r(n.body)})})}function u(r){var t=r;if(!g.accountId||!g.apiKey||!g.realmId)return b.error({description:"AccountId, apiKey, and realmId are required.",func:"addAuthRocketHeaders"}),r;var n={"X-Authrocket-Account":g.accountId,"X-Authrocket-Api-Key":g.apiKey,"X-Authrocket-Realm":g.realmId,"Content-Type":"application/json"};return b.log({description:"addAuthRocketHeaders called.",config:g}),e.each(e.keys(n),function(e){t=c(r,e,n[e])}),b.log({description:"addAuthRocketHeaders request created.",func:"addAuthRocketHeaders"}),t}function c(e,r,t){return r&&t?(b.log({description:"Header value set.",headerName:r,headerVal:t}),e.set(r,t)):void b.error({description:"Header name and value required to add header to request.",func:"addHeaderToReq",obj:"request"})}var a="default"in e?e["default"]:e;r="default"in r?r["default"]:r;var l=Object.defineProperties({},{Realms:{get:function(){return y},configurable:!0,enumerable:!0},Users:{get:function(){return j},configurable:!0,enumerable:!0},Credentials:{get:function(){return k},configurable:!0,enumerable:!0},SignupTokens:{get:function(){return _},configurable:!0,enumerable:!0},Orgs:{get:function(){return A},configurable:!0,enumerable:!0},Memberships:{get:function(){return C},configurable:!0,enumerable:!0},AuthProviders:{get:function(){return O},configurable:!0,enumerable:!0},ConnectedApps:{get:function(){return P},configurable:!0,enumerable:!0},Hooks:{get:function(){return E},configurable:!0,enumerable:!0},Sessions:{get:function(){return R},configurable:!0,enumerable:!0},Events:{get:function(){return w},configurable:!0,enumerable:!0},Notifications:{get:function(){return T},configurable:!0,enumerable:!0}}),f={accountId:process.env.AUTHROCKET_ACCOUNT_ID,apiKey:process.env.AUTHROCKET_API_KEY,realmId:process.env.AUTHROCKET_REALM_ID,jwtSecret:process.env.AUTHROCKET_JWT_SECRET,apiUrl:process.env.AUTHROCKET_API_URL||"https://api-e1.authrocket.com/v1/",jsUrl:process.env.AUTHROCKET_JS_URL},p=null,d=function(){function r(){return _classCallCheck(this,r),p||(p=this),console.log({description:"Config object created.",config:e.merge(this,f),func:"constructor",obj:"Config"}),e.merge(p,f)}return _createClass(r,[{key:"applySettings",value:function(r){var t=this;e.each(e.keys(r),function(e){t[e]=r[e]})}},{key:"urls",get:function(){var e=this.jsUrl,r=this.apiUrl;return Object.defineProperties({},{api:{get:function(){return r?t(r):null},configurable:!0,enumerable:!0},js:{get:function(){return e?t(e):null},configurable:!0,enumerable:!0}})}}]),r}(),g=new d,h="debug";g.logLevel&&(h=g.logLevel);var b={log:function(e){var r=o(e);"production"==g.envName?n("log",r):n("log",r)},info:function(e){var r=o(e);"production"==g.envName?n("info",r):n("info",r)},warn:function(e){var r=o(e);"production"==g.envName?n("warn",r):n("warn",r)},debug:function(e){var r=o(e);"production"==g.envName||n("debug",r)},error:function(e){var r=o(e);"production"==g.envName?n("error",r):n("error",r)}},v={get:function(e,t,n){var o=r.get(e);return t&&o.query(t),o=i(o,n),s(o)},post:function(e,t,n){var o=r.post(e).send(t);return o=i(o,n),s(o)},put:function(e,t,n){var o=r.put(e,t);return o=i(o,n),s(o)},del:function(e,t,n){var o=r.put(e,t);return o=i(o,n),s(o)}},m=function(){function r(e,t,n){_classCallCheck(this,r),this.name=e,this.endpoint=n?n:""+this.name,this.init(t)}return _createClass(r,[{key:"init",value:function(r){b.log({description:"Init action called.",actionData:r,func:"url",obj:"Action"}),this.isList=r?!1:!0,this.isList||(this.actionData=r,e.isString(r)?this.id=this.actionData:e.has(r,"id")||e.has(r,"username")?this.id=r.id?r.id:r.username:(b.warn({description:"Invalid action data object.",func:"constructor",obj:"Action"}),this.isList=!1))}},{key:"get",value:function(){return v.get(this.url).then(function(r){return b.log({description:"Get responded successfully.",res:r,func:"get",obj:"Action"}),e.has(r,"error")?(b.error({description:"Error in get response.",error:r.error,res:r,func:"get",obj:"Action"}),Promise.reject(r.error)):r.collection?r.collection:r},function(e){return b.error({description:"Error in GET request.",error:e,func:"get",obj:"Action"}),Promise.reject(e)})}},{key:"add",value:function(r){return v.post(this.url,r).then(function(r){return b.log({description:"Add request responded successfully.",res:r,func:"add",obj:"Action"}),e.has(r,"error")?(b.error({description:"Error creating new user.",error:r.error,res:r,func:"add",obj:"Action"}),Promise.reject(r.error)):(b.log({description:"Add successful.",res:r,func:"add",obj:"Action"}),r)},function(e){return b.error({description:"Error creating new user.",error:e,func:"add",obj:"Action"}),Promise.reject(e)})}},{key:"update",value:function(r){return v.put(this.url,r).then(function(r){return e.has(r,"error")?(b.error({description:"Error in update request.",error:r.error,res:r,func:"update",obj:"Action"}),Promise.reject(r.error)):(b.log({description:"Update successful.",res:r,func:"update",obj:"Action"}),r)},function(e){return b.error({description:"Error in update request.",error:e,func:"update",obj:"Action"}),Promise.reject(e)})}},{key:"remove",value:function(){return v.del(this.url).then(function(r){return e.has(r,"error")?(b.error({description:"Error in request for removal.",error:r.error,res:r,func:"remove",obj:"Action"}),Promise.reject(r.error)):(b.log({description:"Remove successfully.",res:r,func:"remove",obj:"Action"}),r)},function(e){return b.error({description:"Error in request for removal.",error:e,func:"remove",obj:"Action"}),Promise.reject(e)})}},{key:"url",get:function(){var e=this.isList?g.urls.api+"/"+this.endpoint:g.urls.api+"/"+this.endpoint+"/"+this.id;return b.log({description:"Url created.",url:e,func:"url",obj:"Action"}),e}}]),r}(),y=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"realms",e)}return _inherits(r,e),r}(m),j=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"users",e)}return _inherits(r,e),r}(m),k=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"credentials",e)}return _inherits(r,e),r}(m),_=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"signup_tokens",e)}return _inherits(r,e),r}(m),A=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"orgs",e)}return _inherits(r,e),r}(m),C=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"memberships",e)}return _inherits(r,e),r}(m),O=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"auth_providers",e)}return _inherits(r,e),r}(m),P=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"login_policies",e)}return _inherits(r,e),r}(m),E=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"app_hooks",e)}return _inherits(r,e),r}(m),R=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"session",e)}return _inherits(r,e),r}(m),w=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"events",e)}return _inherits(r,e),r}(m),T=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,"notifications",e)}return _inherits(r,e),r}(m),U=function(){function e(r){_classCallCheck(this,e),r&&a.isString(r)?this.apiUrl=r:g.applySettings(r)}return _createClass(e,[{key:"login",value:function(e){return a.has(e,"username")&&a.has(e,"password")?(b.log({description:"Calling login.",url:g.urls.js+"/login",loginData:e,func:"login",obj:"AuthRocket"}),v.post(g.urls.js+"/login",e,!1).then(function(e){if(a.has(e,"error"))return b.error({description:"Error logging in.",error:e.error,res:e,func:"login",obj:"AuthRocket"}),Promise.reject(e.error);if(a.has(e,"errno")){var r=e.errno,t="Error logging in.";return"ENOTFOUND"===r&&(r="User not found.",t=r),b.error({description:r,error:e.errno,res:e,func:"login",obj:"AuthRocket"}),Promise.reject(r)}return e},function(e){return b.error({description:"Error logging in.",error:e,func:"login",obj:"AuthRocket"}),"ENOTFOUND"===e&&(e="User not found."),Promise.reject(e)})):(b.error({description:"Username and password are required to login.",func:"login",obj:"AuthRocket"}),Promise.reject("Username/Email and password are required."))}},{key:"logout",value:function(e){return e&&a.isString(e)?v.post(g.urls.js+"/logout",{token:e},!1).then(function(e){return a.has(e,"error")||a.has(e,"errno")?(b.error({description:"Error logging out.",error:e.error||e.errno,res:e,func:"logout",obj:"AuthRocket"}),Promise.reject(e.error||e.errno)):(b.log({description:"Successful logout.",res:e,func:"logout",obj:"AuthRocket"}),e)},function(e){return b.error({description:"Error logging out.",error:e}),Promise.reject(e)}):(b.error({description:"Token string is required to logout.",func:"logout",obj:"AuthRocket"}),Promise.reject("Valid token is required to logout."))}},{key:"signup",value:function(e){return(a.has(e,"username")||a.has(e,"email"))&&a.has(e,"username")?v.post(g.urls.js+"/signup",e).then(function(e){return a.has(e,"error")||a.has(e,"errno")?(b.error({description:"Error signing up.",error:e.error||e.errno,res:e,func:"signup",obj:"AuthRocket"}),Promise.reject(e.error||e.errno)):(b.log({description:"Successful signup",res:e,func:"signup",obj:"AuthRocket"}),e)},function(e){return b.error({description:"Error signing up.",error:e,func:"signup",obj:"AuthRocket"}),Promise.reject(e)}):(b.error({description:"Username/Email and password are required to login.",func:"login",obj:"AuthRocket"}),Promise.reject("Username/Email and password are required."))}},{key:"verify",value:function(e){return v.get(g.urls.api+"/sessions/"+e).then(function(e){return b.log({description:"Token/Session is valid.",res:e,func:"verify",obj:"AuthRocket"}),a.has(e,"error")?(b.error({description:"Error verifying token/session.",error:e.error,res:e,func:"verify",obj:"AuthRocket"}),Promise.reject(e.error)):e},function(e){return b.error({description:"Token/Session is invalid.",error:e,func:"verify",obj:"AuthRocket"}),Promise.reject(e)})}},{key:"Realms",value:function(e){return new l.Realms(e)}},{key:"Users",value:function(e){return new l.Users(e)}},{key:"Credentials",value:function(e){return new l.Credentials(e)}},{key:"SignupTokens",value:function(e){return new l.SignupTokens(e)}},{key:"Orgs",value:function(e){return new l.Orgs(e)}},{key:"Memberships",value:function(e){return new l.Memberships(e)}},{key:"AuthProviders",value:function(e){return new l.AuthProviders(e)}},{key:"ConnectedApps",value:function(e){return new l.ConnectedApps(e)}},{key:"Hooks",value:function(e){return new l.Hooks(e)}},{key:"Sessions",value:function(e){return new l.Sessions(e)}},{key:"Events",value:function(e){return new l.Events(e)}},{key:"Notifications",value:function(e){return new l.Notifications(e)}}]),e}();return U});
//# sourceMappingURL=authrocket.min.js.map
