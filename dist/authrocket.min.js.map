{"version":3,"sources":["authrocket.min.js","/source/authrocket.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","global","factory","exports","module","require","define","amd","AuthRocket","_","superagent","this","removeTrailingSlash","url","isString","replace","logger","error","description","func","file","runConsoleMethod","methodName","methodData","console","apply","log","buildMessageArgs","logData","msgStr","msgObj","___default","isObject","logLevel","has","obj","each","omit","keys","ind","list","msg","handleResponse","req","Promise","resolve","reject","end","err","res","status","_logger","warn","response","text","body","defaultConfig","accountId","process","env","AUTHROCKET_ACCOUNT_ID","apiKey","AUTHROCKET_API_KEY","realmId","AUTHROCKET_REALM_ID","jwtSecret","AUTHROCKET_JWT_SECRET","apiUrl","AUTHROCKET_API_URL","jsUrl","AUTHROCKET_JS_URL","configInstance","Config","merge","value","settingsData","_this","get","api","js","config","msgArgs","envName","info","debug","request","endpoint","queryData","query","post","data","send","put","del","settings","applySettings","loginData","urls","then","token","signupData"],"mappings":"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","file":"authrocket.min.js","sourcesContent":[null,"(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('lodash'), require('superagent')) :\n  typeof define === 'function' && define.amd ? define(['lodash', 'superagent'], factory) :\n  global.AuthRocket = factory(global._,global.superagent);\n}(this, function (_,superagent) { 'use strict';\n\n  var ___default = 'default' in _ ? _['default'] : _;\n  superagent = 'default' in superagent ? superagent['default'] : superagent;\n\n  let defaultConfig = {\n  \taccountId: process.env.AUTHROCKET_ACCOUNT_ID,\n  \tapiKey: process.env.AUTHROCKET_API_KEY,\n  \trealmId: process.env.AUTHROCKET_REALM_ID,\n  \tjwtSecret: process.env.AUTHROCKET_JWT_SECRET,\n    apiUrl: process.env.AUTHROCKET_API_URL  || 'https://api-e1.authrocket.com/v1/',\n    jsUrl: process.env.AUTHROCKET_JS_URL\n  };\n  let configInstance = null; //Singleton variable\n  class Config {\n  \tconstructor() {\n  \t\tif (!configInstance) {\n        configInstance = this;\n      }\n  \t\t// console.log({description: 'Config object created.', config: merge(this, defaultConfig), func: 'constructor', obj: 'Config'});\n  \t\treturn _.merge(configInstance, defaultConfig);\n  \t}\n    applySettings(settingsData) {\n      _.each(_.keys(settingsData), (key) => {\n        this[key] = settingsData[key];\n      });\n    }\n    //Map getters that handle removing trailing slash of urls\n    get urls() {\n      let jsUrl = this.jsUrl;\n      let apiUrl = this.apiUrl;\n      return {\n        get api() {\n          return apiUrl ? removeTrailingSlash(apiUrl) : null;\n        },\n        get js() {\n          return jsUrl ? removeTrailingSlash(jsUrl) : null;\n        }\n      };\n    }\n  }\n  let config = new Config();\n\n  function removeTrailingSlash(url) {\n    if (!_.isString(url)) {\n      logger.error({description: 'Slash can only be removed from strings.', func: 'removeTrailingSlash', file: 'config'});\n      return url;\n    }\n    return url.replace(/\\/$/, '');\n  }\n\n  //Set default log level to debug\n  let logLevel = 'debug';\n  //Set log level from config\n  if (config.logLevel) {\n  \tlogLevel = config.logLevel;\n  }\n  let _logger = {\n  \tlog(logData) {\n  \t\tlet msgArgs = buildMessageArgs(logData);\n  \t\tif (config.envName == 'production') {\n  \t\t\trunConsoleMethod('log', msgArgs);\n  \t\t} else {\n  \t\t\trunConsoleMethod('log', msgArgs);\n  \t\t}\n  \t},\n  \tinfo(logData) {\n  \t\tlet msgArgs = buildMessageArgs(logData);\n  \t\tif (config.envName == 'production') {\n  \t\t\trunConsoleMethod('info', msgArgs);\n  \t\t} else {\n  \t\t\trunConsoleMethod('info', msgArgs);\n  \t\t}\n  \t},\n  \twarn(logData) {\n  \t\tlet msgArgs = buildMessageArgs(logData);\n  \t\tif (config.envName == 'production') {\n  \t\t\trunConsoleMethod('warn', msgArgs);\n  \t\t} else {\n  \t\t\trunConsoleMethod('warn', msgArgs);\n  \t\t}\n  \t},\n  \tdebug(logData) {\n  \t\tlet msgArgs = buildMessageArgs(logData);\n  \t\tif (config.envName == 'production') {\n  \t\t\t// runConsoleMethod('debug', msgArgs);\n  \t\t\t//Do not display console debugs in production\n  \t\t} else {\n  \t\t\trunConsoleMethod('debug', msgArgs);\n  \t\t}\n  \t},\n  \terror(logData) {\n  \t\tlet msgArgs = buildMessageArgs(logData);\n  \t\tif (config.envName == 'production') {\n  \t\t\t//TODO: Log to external logger\n  \t\t\trunConsoleMethod('error', msgArgs);\n  \t\t} else {\n  \t\t\trunConsoleMethod('error', msgArgs);\n  \t\t}\n  \t}\n  };\n\n  function runConsoleMethod(methodName, methodData) {\n  \t//Safley run console methods or use console log\n  \tif (methodName && console[methodName]) {\n  \t\treturn console[methodName].apply(console, methodData);\n  \t} else {\n  \t\treturn console.log.apply(console, methodData);\n  \t}\n  }\n  function buildMessageArgs(logData) {\n  \tvar msgStr = '';\n  \tvar msgObj = {};\n  \t//TODO: Attach time stamp\n  \t//Attach location information to the beginning of message\n  \tif (___default.isObject(logData)) {\n  \t\tif (logLevel == 'debug') {\n  \t\t\tif (___default.has(logData, 'func')) {\n  \t\t\t\tif (___default.has(logData, 'obj')) {\n  \t\t\t\t\t//Object and function provided\n  \t\t\t\t\tmsgStr += `[${logData.obj}.${logData.func}()]\\n `;\n  \t\t\t\t} else if (___default.has(logData, 'file')) {\n  \t\t\t\t\tmsgStr += `[${logData.file} > ${logData.func}()]\\n `;\n  \t\t\t\t} else {\n  \t\t\t\t\tmsgStr += `[${logData.func}()]\\n `;\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n  \t\t//Print each key and its value other than obj and func\n  \t\t___default.each(___default.omit(___default.keys(logData)), (key, ind, list) => {\n  \t\t\tif (key != 'func' && key != 'obj') {\n  \t\t\t\tif (key == 'description' || key == 'message') {\n  \t\t\t\t\tmsgStr += logData[key];\n  \t\t\t\t} else if (___default.isString(logData[key])) {\n  \t\t\t\t\t// msgStr += key + ': ' + logData[key] + ', ';\n  \t\t\t\t\tmsgObj[key] = logData[key];\n  \t\t\t\t} else {\n  \t\t\t\t\t//Print objects differently\n  \t\t\t\t\t// msgStr += key + ': ' + logData[key] + ', ';\n  \t\t\t\t\tmsgObj[key] = logData[key];\n  \t\t\t\t}\n  \t\t\t}\n  \t\t});\n  \t\tmsgStr += '\\n';\n  \t} else if (___default.isString(logData)) {\n  \t\tmsgStr = logData;\n  \t}\n  \tvar msg = [msgStr, msgObj];\n\n  \treturn msg;\n  }\n\n  let request = {\n  \tget(endpoint, queryData) {\n  \t\tvar req = superagent.get(endpoint);\n  \t\tif (queryData) {\n  \t\t\treq.query(queryData);\n  \t\t}\n  \t\t// req = addAuthHeader(req);\n  \t\treturn handleResponse(req);\n  \t},\n  \tpost(endpoint, data) {\n  \t\tvar req = superagent.post(endpoint).send(data);\n  \t\t// req = addAuthHeader(req);\n  \t\treturn handleResponse(req);\n  \t},\n  \tput(endpoint, data) {\n  \t\tvar req = superagent.put(endpoint, data);\n  \t\t// req = addAuthHeader(req);\n  \t\treturn handleResponse(req);\n  \t},\n  \tdel(endpoint, data) {\n  \t\tvar req = superagent.put(endpoint, data);\n  \t\t// req = addAuthHeader(req);\n  \t\treturn handleResponse(req);\n  \t}\n  };\n\n  //Wrap response in promise that has error handling\n  function handleResponse(req) {\n  \treturn new Promise((resolve, reject) => {\n  \t\treq.end((err, res) => {\n  \t\t\tif (!err) {\n  \t\t\t\t// logger.log({description: 'Response:', response:res, func:'handleResponse', file: 'request'});\n  \t\t\t\treturn resolve(res.body);\n  \t\t\t} else {\n  \t\t\t\tif (err.status == 401) {\n  \t\t\t\t\t_logger.warn({description: 'Unauthorized. You must be signed into make this request.', func: 'handleResponse'});\n  \t\t\t\t}\n  \t\t\t\tif (err && err.response) {\n  \t\t\t\t\treturn reject(err.response.text);\n  \t\t\t\t}\n  \t\t\t\t_logger.warn({description: 'Error response.', error: err, func: 'handleResponse'});\n  \t\t\t\treturn reject(err);\n  \t\t\t}\n  \t\t});\n  \t});\n  }\n\n  class AuthRocket {\n    constructor(settings) {\n      if (settings && ___default.isString(settings)) {\n        this.apiUrl = settings;\n      } else {\n        //Set api url if within settings\n        config.applySettings(settings);\n      }\n    }\n    /** Login as a user\n     * @param {Object} loginData - Object containing data to signup with\n     * @param {String} loginData.email - Email of new user\n     * @param {String} loginData.password - Password of new user\n     * @return {Promise}\n     */\n    login(loginData) {\n      return request.post(`${config.urls.js}/login`, loginData).then((res) => {\n        _logger.log({description: 'successful login', res: res});\n        //TODO: Handle error response that comes through 200\n        return res;\n      }, (error) => {\n        _logger.error({description: 'Error logging in.', error: error});\n        return Promise.reject(error);\n      });\n    }\n    /** Logout a user\n     * @param {Object} token - Object containing data to signup with\n     * @return {Promise}\n     */\n    logout(token) {\n      console.log('config:', config.urls.js);\n      return request.post(`${config.urls.js}/logout`, {token: token}).then((res) => {\n        _logger.log({description: 'successful logout', res: res});\n        //TODO: Handle error response that come through 200\n        return res;\n      }, (error) => {\n        _logger.error({description: 'Error logging out.', error: error});\n        return Promise.reject(error);\n      });\n    }\n    /** Signup a new user\n     * @param {Object} signupData - Object containing data to signup with\n     * @param {String} signupData.email - Email of new user\n     * @param {String} signupData.password - Password of new user\n     * @param {String} signupData.confirm - Object containing data to signup with\n     * @return {Promise}\n     */\n    signup(signupData) {\n      return request.post(`${config.urls.js}/signup`, signupData).then((res) => {\n        _logger.log({description: 'Successful signup', res: res, func: 'signup', obj: 'AuthRocket'});\n        //TODO: Handle error response that comes through 200\n        return res;\n      }, (err) => {\n        _logger.error({description: 'Error signing up.', error: err, func: 'signup', obj: 'AuthRocket'});\n        return Promise.reject(error);\n      });\n    }\n    /** Verify an existing token is valid\n     * @param {String} token - JSON Web Token to verify\n     * @return {Promise}\n     */\n    verify(token) {\n      return request.post(`${config.urls.js}/sessions/${token}`).then((res) => {\n        _logger.log({description: 'token is valid', res: res, func: 'verify', obj: 'AuthRocket'});\n        return res;\n      }, (err) => {\n        _logger.error({description: 'Token is invalid.', error: err, func: 'verify', obj: 'AuthRocket'});\n        return Promise.reject(err);\n      });\n    }\n    /** Attach AuthRocket request headers and make a request\n     * @param {String} endpoint - Endpoint to send request to\n     * @param {Object|String} data - Request data\n     * @return {Promise}\n     */\n     requestWithHeaders(url, data) {\n\n     }\n  }\n\n  return AuthRocket;\n\n}));"],"sourceRoot":"/source/"}